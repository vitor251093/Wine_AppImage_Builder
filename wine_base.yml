app: Wine
binpatch: true
ingredients:
  dist: __distribution_version__
  packages: 
    - bash
    - cabextract
    - dash
    - perl
    - coreutils
    - mesa-utils
    - unionfs-fuse
  sources:
    - deb http://deb.debian.org/debian __distribution_version__ main contrib non-free
  script:
    - wget -c __package_url__
script:
  # Create wrapper file manually
  - cat > ./usr/bin/winewrapper << 'EOF'
  - WRAPPER_FILE
  - EOF
  - chmod +x ./usr/bin/winewrapper
  # Add winetricks
  - wget -q "https://raw.githubusercontent.com/Winetricks/winetricks/master/src/winetricks" -P ./bin && chmod +x ./bin/winetricks
  # Add required desktop file
  - wget -N https://source.winehq.org/git/wine.git/blob_plain/HEAD:/loader/wine.desktop
  - sed -i -e 's|Icon=wine.*|Icon=/usr/share/icons/wine.svg|g' wine.desktop
  - sed -i -e 's|Name=Wine.*|Name=Wine|g' wine.desktop
  - sed -i -e '/Name\[.*/d' wine.desktop
  - sed -i -e 's|Exec=wine.*|Exec=winewrapper|g' wine.desktop
  - echo 'Categories=Utility;Settings;' >> wine.desktop
  - mkdir -p ./usr/share/applications/
  - rm ./usr/share/applications/wine.desktop || true
  - cp ./wine.desktop ./usr/share/applications/wine.desktop
  # Copy App icon to usr/share/icons needed prior to appimage-builder ver 1.x.x
  - mkdir -p usr/share/icons
  - wget -N https://source.winehq.org/git/wine.git/blob_plain/HEAD:/dlls/wineandroid.drv/wine.svg
  - cp wine.svg usr/share/icons
  # Add WINE official light blue theme
  - wget -q "https://github.com/mmtrt/sommelier-core/raw/master/themes/light/light.msstyles" -P ./winedata/resources/themes/light
